{
  "version": 1,
  "type": "cam-pipeline",
  "exportedAt": "2026-02-23T01:21:43.557Z",
  "name": "端到端｜从文档到 MVP 实现交付",
  "agentDefinitionId": "codex",
  "repoUrl": null,
  "baseBranch": null,
  "workDir": null,
  "maxRetries": 2,
  "steps": [
    {
      "title": "分析/审查：MVP 需求澄清与验收定义（仅分析版）",
      "description": "# MVP 需求澄清与验收定义（仅分析版）\n\n【输入】\n- source_doc_path：简单需求文档路径（必填，如 `E:\\Code\\CampusHelpATW\\项目思想.txt`）。\n- scope：MVP 范围（可留空；默认由文档与仓库现状推断）。\n- target_users：目标用户与核心场景（可留空）。\n- report_path：报告路径（默认 `.conversations/reports/mvp-requirements-clarification-report.md`）。\n- acceptance_criteria：至少包含“问题定义、MVP 边界、可测试验收标准、非目标、关键风险”。\n- constraints：时间预算、不可触碰范围、是否允许改公共 API、是否允许新增依赖。\n\n【需要完成的功能】\n- 仅做需求澄清：基于文档与仓库现状，补全可执行的 MVP 需求定义与验收口径（不改代码）。\n\n【注意事项】\n- 通用分析基线（必须）：先确认目标与约束（≤3 行）→扫描文档与仓库事实→输出可执行需求定义；最多追问 3 个阻塞问题；每条 `acceptance_criteria` 必须映射证据；按【输出】原样输出。\n- 充分利用 CLI Agent 默认能力：自动识别技术栈、入口命令、关键模块；不要要求用户额外提供目录树或技术细节。\n- 避免冗余：只保留“目标、验收、约束、风险、下一步”五类信息；不要重复讲解仓库扫描过程。\n- 验收标准必须可测试（可量化指标或 Given/When/Then），并显式区分“做什么”和“不做什么”。\n- 能跑就跑探测命令并留痕；不能跑写阻塞原因与可信度影响。\n- 报告必须落盘到 `report_path`，并在结尾回写路径与摘要。\n\n【输出】\n- 输入完整性检查（缺失项与补全假设）。\n- 现状基线（文档关键信息、仓库相关能力、约束边界）。\n- MVP 目标与非目标（必须分开列出）。\n- 用户故事与关键流程（最多 3 条核心路径）。\n- MVP 功能清单（Must/Should/Could，含取舍理由）。\n- 验收标准清单（逐条可验证，含验证方式）。\n- 风险与假设（技术/产品/交付，附缓解动作）。\n- 下一步执行建议（进入“实施计划制定”所需输入）。\n- 分析报告（已保存路径 + 报告摘要）。\n- 验收映射表（acceptance_criteria → 证据 → 结论）。\n- 机器可读摘要（JSON）：{\"status\":\"success|partial|blocked\",\"scope\":[],\"mvp_goals\":[],\"non_goals\":[],\"acceptance\":[],\"risks\":[],\"next_actions\":[]}。\n\n流水线通信要求（必须执行）：\n- 本步骤结束前必须写入以下文件：\n  1) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-summary.md\n  2) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-handoff.json\n- `step1-summary.md` 必须包含：输入范围、关键发现（P0/P1/P2）、报告路径、阻塞项。\n- `step1-handoff.json` 必填字段：\n  - pipeline_id（固定为当前流水线 id）\n  - step（固定为 \"step1\"）\n  - upstream_title（固定为 \"MVP 需求澄清与验收定义（仅分析版）\"）\n  - upstream_report_path（本步骤实际产出的 report_path）\n  - summary_path（固定为 \".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-summary.md\"）\n  - priority_items（数组，按优先级排序）\n  - blockers（数组）\n  - generated_at（ISO 时间）",
      "agentDefinitionId": "codex"
    },
    {
      "title": "实施计划：MVP 实施计划制定（仅分析版）",
      "description": "# MVP 实施计划制定（仅分析版）\n\n【输入】\n- requirements_report_path：需求澄清报告路径（默认 `.conversations/reports/mvp-requirements-clarification-report.md`）。\n- source_doc_path：原始文档路径（可选，用于交叉核对）。\n- scope：计划覆盖范围（模块/目录/子系统，可留空由仓库推断）。\n- report_path：报告路径（默认 `.conversations/reports/mvp-implementation-plan-report.md`）。\n- acceptance_criteria：至少包含“里程碑、任务分解、验证门禁、回滚策略、风险处理”。\n- constraints：交付周期、资源限制、不可变更项、是否允许并行开发。\n\n【需要完成的功能】\n- 仅做实施计划制定：把 MVP 需求转成可执行计划（不改代码）。\n\n【注意事项】\n- 通用分析基线（必须）：先读取 `requirements_report_path` 并确认目标→再输出分阶段计划；最多追问 3 个阻塞问题；每条 `acceptance_criteria` 必须映射证据；按【输出】原样输出。\n- 计划必须“可直接执行”：每步都给目标、影响面、验证方式、失败回滚点。\n- 充分利用 CLI Agent 默认能力：自动扫描仓库结构，识别现有实现可复用点，减少重复建设。\n- 避免冗余：不重复大段需求背景，只输出实施决策、任务编排与依赖关系。\n- 必须给出执行优先级与并行切分建议，保证最小可用版本优先落地。\n- 报告必须落盘到 `report_path`，并在结尾回写路径与摘要。\n\n【输出】\n- 输入确认结果（需求来源、范围、约束、假设）。\n- 实施策略（技术路线、复用点、裁剪点）。\n- 里程碑与阶段目标（建议 2-4 个阶段）。\n- 任务分解清单（按阶段列出；每项含目标/影响面/验证/回滚）。\n- 关键依赖与阻塞项（外部依赖、前置条件、并行关系）。\n- 验证门禁设计（每阶段进入下一阶段前必须满足的条件）。\n- 回归与发布策略（MVP 交付最小检查集）。\n- 下一步执行指令（进入“根据计划实现 MVP”所需输入）。\n- 分析报告（已保存路径 + 报告摘要）。\n- 验收映射表（acceptance_criteria → 计划项 → 证据）。\n- 机器可读摘要（JSON）：{\"status\":\"success|partial|blocked\",\"scope\":[],\"milestones\":[],\"execution_plan\":[],\"dependencies\":[],\"risks\":[],\"next_actions\":[]}。\n\n流水线通信要求（必须执行）：\n- 本步骤开始前必须读取以下文件：\n  1) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-summary.md\n  2) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-handoff.json\n- 若通信文件缺失或字段不完整：必须先输出阻塞原因与修复动作，不得直接跳过。\n- 本步骤仅输出可执行计划，不改代码；计划需覆盖里程碑、影响面、验证与回滚策略。\n- 本步骤结束前必须写入以下文件：\n  1) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-summary.md\n  2) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-handoff.json\n- `step2-summary.md` 必须包含：目标拆解、执行顺序、风险点、验证门禁。\n- `step2-handoff.json` 必填字段：\n  - pipeline_id / step(\"step2\")\n  - input_handoff_path（固定为 \".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-handoff.json\"）\n  - summary_path（固定为 \".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-summary.md\"）\n  - milestones（数组）\n  - execution_plan（数组）\n  - blockers（数组）\n  - generated_at（ISO 时间）",
      "agentDefinitionId": "codex"
    },
    {
      "title": "执行落地：根据计划实现 MVP（仅执行版）",
      "description": "# 根据计划实现 MVP（仅执行版）\n\n【输入】\n- plan_report_path：实施计划报告路径（默认 `.conversations/reports/mvp-implementation-plan-report.md`）。\n- requirements_report_path：需求澄清报告路径（可选，默认 `.conversations/reports/mvp-requirements-clarification-report.md`）。\n- scope：允许改动范围（目录/模块/接口）。\n- acceptance_criteria：至少包含“核心流程可用、关键验收项通过、回归通过、可演示”。\n- constraints：不可改动项、时间预算、是否允许重构/新增依赖/补测试。\n- （可留空）upstream_handoff_path：上一步交接文件路径。\n- （可留空）handoff_output_dir：默认 `.conversations/pipeline-handoffs/<pipeline_id>/`。\n\n【需要完成的功能】\n- 基于需求澄清与实施计划执行 MVP 开发，交付可运行、可验证的最小可用版本。\n\n【注意事项】\n- 通用执行基线（必须）：先读取 `plan_report_path` 并确认执行目标（≤3 行）→扫描仓库事实→3-7 步执行（每步含影响面/验证/回滚）→回填证据；最多追问 3 个阻塞问题；每条 `acceptance_criteria` 必须映射证据；至少 1 条失败路径验证；按【输出】原样输出。\n- 严格按计划落地：逐条映射“计划项 → 代码改动 → 验证结果”；偏离计划必须说明原因与风险。\n- 充分利用 CLI Agent 默认能力：自动探测可运行命令并执行，不要要求用户补充无关工程细节。\n- 开发阶段允许激进修复与重构，但必须写明影响面、迁移方式和回滚点。\n- 能跑就跑 test/lint/build/typecheck/smoke 并留痕；不能跑写阻塞原因与最小手工回归步骤。\n- 如提供 `handoff_output_dir`，结束时必须写 `step-summary.md` 与 `step-handoff.json`。\n\n【输出】\n- 输入确认结果（计划来源、纳入范围、验收口径）。\n- 执行计划（3-7 步：目标/影响面/验证/回滚点）。\n- 变更清单（按文件：改动内容/原因/对应计划项）。\n- 验证命令与结果摘要（失败项单列）。\n- 风险补充（未完成项/原因/下一步）。\n- 回归清单（核心流程、关键接口、边界状态）。\n- 流水线交接文件（若提供 `handoff_output_dir`：`step-summary.md` + `step-handoff.json`）。\n- 验收映射表（acceptance_criteria → 改动点 → 验证证据）。\n- 机器可读摘要（JSON）：{\"status\":\"success|partial|blocked\",\"scope\":[],\"changed_files\":[],\"verification\":[],\"unresolved\":[],\"next_actions\":[]}。\n\n流水线通信要求（必须执行）：\n- 本步骤开始前必须读取以下文件：\n  1) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-summary.md\n  2) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-handoff.json\n  3) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-summary.md\n  4) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-handoff.json\n- 若通信文件缺失或字段不完整：必须先输出阻塞原因与修复动作，不得直接跳过。\n- 本步骤执行必须逐条映射 step2 的计划项，并在输出中给出“计划项 → 改动 → 验证”映射。\n- 本步骤结束前必须写入以下文件：\n  1) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step3-summary.md\n  2) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step3-handoff.json\n- `step3-summary.md` 必须包含：执行进展、变更清单、验证结果、未完成项。\n- `step3-handoff.json` 必填字段：\n  - pipeline_id / step(\"step3\")\n  - input_handoffs（固定为 [\".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-handoff.json\", \".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-handoff.json\"]）\n  - summary_path（固定为 \".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step3-summary.md\"）\n  - changed_files（数组）\n  - verification_commands（数组）\n  - unresolved_items（数组）\n  - generated_at（ISO 时间）\n\n补充要求：\n1. 必须基于 step2 计划逐条落地，不允许跳过高优先级计划项。\n2. 若 step2 输出了里程碑与顺序，必须保持一致，偏离时说明原因与风险。\n3. 本步骤必须实际改代码并完成验证，不仅给结论。",
      "agentDefinitionId": "codex"
    },
    {
      "title": "复审核验：MVP 交付回归审查（仅审查版）",
      "description": "# MVP 交付回归审查（仅审查版）\n\n【输入】\n- scope：复审范围（模块/目录/接口/页面，可留空默认全量相关改动）。\n- report_path：报告路径（默认 `.conversations/reports/mvp-delivery-regression-review-report.md`）。\n- requirements_report_path：需求澄清报告路径（默认 `.conversations/reports/mvp-requirements-clarification-report.md`）。\n- plan_report_path：实施计划报告路径（默认 `.conversations/reports/mvp-implementation-plan-report.md`）。\n- execution_handoff_path：执行步骤交接文件路径（如 `.conversations/pipeline-handoffs/<pipeline_id>/step3-handoff.json`）。\n- acceptance_criteria：至少包含“需求达成度、关键路径回归、风险状态、可交付结论”。\n- constraints：审查深度、时间预算、是否允许运行验证命令。\n- （可留空）handoff_output_dir：默认 `.conversations/pipeline-handoffs/<pipeline_id>/`。\n\n【需要完成的功能】\n- 仅做 MVP 交付回归审查：确认需求达成、计划执行完整且无关键回退（不改代码）。\n\n【注意事项】\n- 通用审查基线（必须）：先读取需求/计划/执行证据→再分级问题→最后给通过结论；最多追问 3 个阻塞问题；每条 `acceptance_criteria` 必须映射证据；按【输出】原样输出。\n- 严格单一职责：仅审查不改代码。\n- 必须逐条核对“需求项 → 计划项 → 实际改动 → 验证证据”，缺一项即标记为未闭环。\n- 重点覆盖：核心用户流程、关键接口、失败路径、边界状态、已知高风险点。\n- 报告必须落盘到 `report_path`；如提供 `handoff_output_dir`，结束时写 `step-summary.md` 与 `step-handoff.json`。\n\n【输出】\n- 扫描结论（复审范围、输入来源、可用证据、可信度说明）。\n- 问题清单（P0/P1/P2：位置/影响/证据/修复建议/验证方式）。\n- 需求达成矩阵（需求项 → 达成状态 → 证据）。\n- 计划执行闭环矩阵（计划项 → 执行状态 → 证据）。\n- 回归风险清单（功能/性能/兼容性/维护成本）。\n- 验证清单（已执行命令与结果摘要；未执行项手工步骤）。\n- 审查报告（已保存路径 + 报告摘要）。\n- 复审结论（通过/需继续整改/阻塞）。\n- 流水线交接文件（若提供 `handoff_output_dir`：`step-summary.md` + `step-handoff.json`）。\n- 验收映射表（acceptance_criteria → 证据 → 结论）。\n- 机器可读摘要（JSON）：{\"status\":\"success|partial|blocked\",\"scope\":[],\"delivery_status\":[],\"regression_risks\":[],\"next_actions\":[]}。\n\n流水线通信要求（必须执行）：\n- 本步骤开始前必须读取以下文件：\n  1) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-summary.md\n  2) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-handoff.json\n  3) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-summary.md\n  4) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-handoff.json\n  5) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step3-summary.md\n  6) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step3-handoff.json\n- 若通信文件缺失或字段不完整：必须先输出阻塞原因与修复动作，不得直接跳过。\n- 本步骤复审必须逐条核对 step3 的改动与验证证据，输出“问题关闭状态 + 回归风险”。\n- 本步骤结束前必须写入以下文件：\n  1) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step4-summary.md\n  2) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step4-handoff.json\n- `step4-summary.md` 必须包含：复审结论、问题关闭状态、回归风险、阻塞项。\n- `step4-handoff.json` 必填字段：\n  - pipeline_id / step(\"step4\")\n  - input_handoffs（固定为 [\".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-handoff.json\", \".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-handoff.json\", \".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step3-handoff.json\"]）\n  - summary_path（固定为 \".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step4-summary.md\"）\n  - review_decision（approved / revise_required / blocked）\n  - closed_items（数组）\n  - open_items（数组）\n  - generated_at（ISO 时间）",
      "agentDefinitionId": "codex"
    },
    {
      "title": "端到端交付验收",
      "description": "请基于上一步执行结果进行最终校验与交付整理：\n1. 对照原始目标逐条核对完成状态，明确已完成/未完成/阻塞项。\n2. 汇总可验证证据（命令、结果摘要、关键输出路径）。\n3. 输出可直接交付的结构化结果：变更清单、验证结果、回归清单、风险与下一步行动。\n4. 若上一步是审查或分析任务，必须确认报告已落盘并给出保存路径与摘要。\n\n流水线通信要求（必须执行）：\n- 本步骤开始前必须读取以下文件：\n  1) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-summary.md\n  2) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-handoff.json\n  3) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-summary.md\n  4) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-handoff.json\n  5) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step3-summary.md\n  6) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step3-handoff.json\n  7) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step4-summary.md\n  8) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/step4-handoff.json\n- 若存在缺失：必须先输出阻塞原因，不得直接给“已完成”。\n- 本步骤结束前必须写入以下文件：\n  1) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/final-delivery.md\n  2) .conversations/pipeline-handoffs/11-从文档到MVP实现交付/final-delivery.json\n- `final-delivery.md` 必须包含：完成度核对、证据清单、回归清单、风险与下一步行动。\n- `final-delivery.json` 必填字段：\n  - pipeline_id / step(\"final\")\n  - input_handoffs（固定为 [\".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step1-handoff.json\",\".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step2-handoff.json\",\".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step3-handoff.json\",\".conversations/pipeline-handoffs/11-从文档到MVP实现交付/step4-handoff.json\"]）\n  - summary_path（固定为 \".conversations/pipeline-handoffs/11-从文档到MVP实现交付/final-delivery.md\"）\n  - status（success / partial / blocked）\n  - completed_items（数组）\n  - pending_items（数组）\n  - generated_at（ISO 时间）",
      "agentDefinitionId": "codex"
    }
  ]
}
