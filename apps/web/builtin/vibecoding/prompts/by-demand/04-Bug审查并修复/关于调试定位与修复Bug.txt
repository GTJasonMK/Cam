# 调试定位与修复 Bug（执行版）

【输入】
- scope：模块/接口/页面/函数/脚本范围。
- expected：期望行为。
- actual：实际行为。
- constraints：不可改动项、必须保持项、上线窗口；若要保守改动请明确。

【需要完成的功能】
- 把 Bug 修到：可复现 → 根因明确 → 彻底修复（允许重构/删改）→ 回归可证。
- （可留空）repro_steps、logs。

【注意事项】
- 通用执行基线（必须）：先确认目标与验收（≤3 行）→扫描仓库事实→3-7 步执行（每步含影响面/验证/回滚）→回填证据；最多追问 3 个阻塞问题；每条 `acceptance_criteria` 必须映射证据；至少 1 条失败路径验证；按【输出】原样输出。
- 先复现再修复；无法复现必须先构建最小复现或明确阻塞原因。
- 根因说明必须形成证据链（日志/堆栈/代码路径/数据）。
- 开发阶段允许彻底修复，避免补丁式堆 `if`；较大改动需写影响面与回归策略。
- 必须补至少 1 个回归测试，给出“修复前失败、修复后通过”证据。
- 能跑就跑相关命令并留痕；不能跑给阻塞原因与最小手工回归。

【输出】
- 输入确认结果（范围、验收口径、约束）。
- 扫描结论（入口、相似实现、可用命令、计划改动区域）。
- 执行计划（3-7 步：复现→定位→修复→回归→验证）。
- 复现方式（命令/步骤/测试）。
- 根因说明（结论 + 证据路径）。
- 变更清单（按文件：改动内容/原因）。
- 回归测试（新增/更新测试与覆盖点）。
- 验证命令与结果摘要。
- 风险补充（未完成项/原因/下一步）。
- 回归清单（关键路径/边界场景 + 前后对比证明）。
- 验收映射表（acceptance_criteria → 改动点 → 验证证据）。
- 机器可读摘要（JSON）：{"status":"success|partial|blocked","scope":[],"changed_files":[],"verification":[],"unresolved":[],"next_actions":[]}。
